#!/bin/bash

[ $EUID -ne 0 ] && exec sudo "$0"

# Explicitly installed orphaned packages not in base/base-devel
candidates="$(comm -23 <(pacman -Qqte | sort) <({ pacman -Qqg base-devel; echo base; } | sort -u) | fzf \
	--preview 'pacman -Qil {}' \
	--reverse \
    --multi --marker="*" \
    --header '<Tab> select for removal, <Enter> accept, <Esc> cancel')"

[ -z "$candidates" ] || pacman -Rns $candidates
